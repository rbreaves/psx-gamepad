<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Playstation Gamepad Conversion</title>
<style>
  body {
    margin: 0;
    padding: 4px 8px;
    font-family: sans-serif;
    font-size: 14px;
    font-weight: bold;
    background: #000;
    color: #fff;

    display: grid;
    grid-template-columns: auto 1fr auto; /* left | center | right */
    align-items: center;
    column-gap: 16px;
  }

  #left   { display: flex; align-items: center; gap: 16px; }
  #center { display: flex; justify-content: center; align-items: center; gap: 12px; }
  #right  { display: flex; justify-content: flex-end; align-items: center; gap: 8px; }
  #systemGroup { display: flex; flex-direction: row; gap: 6px; }

  /* Left-justify mode */
  .left-justify {
    grid-template-columns: 1fr; /* single column */
  }
  .left-justify #center,
  .left-justify #right {
    display: contents; /* let JS move their children */
  }

  /* Vertical layout mode (rotation) */
  .vertical {
    grid-template-columns: 1fr;
    grid-template-rows: auto auto auto;
    row-gap: 12px;
    justify-items: start;   /* align left, not center */
  }
  .vertical #left,
  .vertical #center,
  .vertical #right {
    justify-content: flex-start; /* align contents left */
  }

  /* hide justify toggle when vertical */
  .vertical #layoutBtn {
    display: none;
  }

  /* Stack mapping buttons vertically in vertical mode */
  .vertical #mapping {
    display: flex;
    flex-direction: column;
    align-items: flex-start; /* keep them left justified */
    gap: 6px;               /* spacing between buttons */
  }
  .vertical #mapping .slot {
    display: block;
    min-width: unset;       /* don’t force horizontal spacing */
    text-align: left;
  }



  #datetime { cursor: pointer; white-space: nowrap; }
  #mapping { white-space: nowrap; cursor: pointer; }

  .slot { display: inline-block; min-width: 60px; text-align: center; }
  .slot.empty { opacity: 0.25; }

  button {
    background: none;
    border: none;
    padding: 2px 6px;
    margin: 0;
    color: inherit;
    font: inherit;
    cursor: pointer;
    display: flex;
    align-items: center;
  }
  .avatar {
    width: 18px; height: 18px;
    display: flex; align-items: center; justify-content: center;
    font-size: 12px; font-weight: bold; color: #fff;
  }
  .xbox-avatar     { background: #107c10; border-radius: 50%; }
  .nintendo-avatar { background: #e60012; border-radius: 4px; }
  .sega-avatar     { background: #4169E1;
    clip-path: polygon(50% 0%,93% 25%,93% 75%,50% 100%,7% 75%,7% 25%);
  }

  .mapping-pair { position: relative; display: inline-block; font-size: 24px; line-height: 1; margin: 0 10px; vertical-align: middle; }
  .mapping-pair .left { display: block; }
  .mapping-pair .right {
    position: absolute; left: 50%; top: 50%; transform: translate(-50%, -50%);
    font-size: 14px; font-weight: 900;
    text-shadow:-1px -1px 0 #000,1px -1px 0 #000,-1px 1px 0 #000,1px 1px 0 #000;
  }
  .mapping-pair .right.top-right { top: 0.15em; transform: translateX(-50%); }
  .mapping-pair .right.bottom    { top: auto; bottom: 0.10em; transform: translateX(-50%); }

  .psx-x   { color: #4da6ff; font-weight: 900; text-shadow: 0 0 2px #4da6ff; }
  .psx-o   { color: #ff4d4d; font-weight: 900; text-shadow: 0 0 2px #ff4d4d; }
  .psx-sq  { color: #ff66cc; font-weight: 900; text-shadow: 0 0 2px #ff66cc; }
  .psx-tri { color: #66ff66; font-weight: 900; text-shadow: 0 0 2px #66ff66; }
  .psx-bumper { color: #4da6ff; }

  .xbox-a { color: #66ff66; }
  .xbox-b { color: #ff4d4d; }
  .xbox-x { color: #4da6ff; }
  .xbox-y { color: #ffcc00; }

  .nintendo-a, .nintendo-b, .nintendo-x, .nintendo-y,
  .sega-a, .sega-b, .sega-x, .sega-y, .sega-c, .sega-z { color: #fff; }

  /* target steamdeck only */
  /*
  @media (device-width: 853px) and (device-height: 533px) {
    .psx-x { font-size: 26px !important; }
    .psx-o { font-size: 22px !important; position: relative; top: -3px; }
    .psx-sq { position: relative; top: -2px; }
    .psx-tri { position: relative; top: -2px; }
    .psx-bumper { color: #4da6ff; font-size: 22px !important; position: relative; top: 2px; }
    .xbox-a { position: relative; font-size: 11px !important;}
    .xbox-y { font-size: 12px !important; top: 52% !important;}
  }
  */
</style>
</head>
<body>
  <div id="left"><div id="datetime">—</div></div>
  <div id="center"><div id="mapping">—</div></div>
  <div id="right">
    <div id="systemGroup">
      <button id="cycleBtn" title="Cycle system"><span id="avatar" class="avatar xbox-avatar">X</span></button>
      <button id="layoutBtn" title="Toggle justify">⇔</button>
      <button id="rotateBtn" title="Toggle orientation">↕</button>
    </div>
  </div>

<script>
let overlayMode = true;
const targets = ["xbox","nintendo","sega"];
let currentIndex = 0;
let leftMode = false;
let verticalMode = false;

function render(){
  const target = targets[currentIndex];
  const set = overlayMode ? overlayConversions : equalsConversions;
  let items = [...set[target]];
  while(items.length < 6) items.push('<span class="slot empty"></span>');

  // reverse order in vertical mode
  if (verticalMode) {
    items.reverse();
  }

  items = items.map(item => `<span class="slot">${item}</span>`);
  document.getElementById("mapping").innerHTML = items.join("");

  const avatar=document.getElementById("avatar");
  if(target==="xbox"){avatar.className="avatar xbox-avatar";avatar.textContent="X";}
  else if(target==="nintendo"){avatar.className="avatar nintendo-avatar";avatar.textContent="N";}
  else{avatar.className="avatar sega-avatar";avatar.textContent="S";}

  // reset to default before applying modes
  resetHorizontalLayout();

  document.body.classList.toggle("left-justify", leftMode && !verticalMode);
  document.body.classList.toggle("vertical", verticalMode);

  if(leftMode && !verticalMode){
    // move everything into the left container
    const left = document.getElementById("left");
    left.appendChild(document.getElementById("mapping"));
    left.appendChild(document.getElementById("systemGroup"));
  }
}


document.getElementById("cycleBtn").addEventListener("click",()=>{currentIndex=(currentIndex+1)%targets.length;render();});
document.getElementById("layoutBtn").addEventListener("click",()=>{leftMode=!leftMode;render();});
document.getElementById("rotateBtn").addEventListener("click",()=>{verticalMode=!verticalMode;render();});
document.getElementById("mapping").addEventListener("click",()=>{overlayMode=!overlayMode;render();});
document.getElementById("datetime").addEventListener("click",()=>{timeMode=(timeMode+1)%4;updateClock();});

function resetHorizontalLayout() {
  document.getElementById("left").appendChild(document.getElementById("datetime"));
  document.getElementById("center").appendChild(document.getElementById("mapping"));
  document.getElementById("right").appendChild(document.getElementById("systemGroup"));
}


const days=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];
const months=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];
let timeMode=0;

function updateClock(){
  const now=new Date();
  let hours=now.getHours();
  const minutes=now.getMinutes().toString().padStart(2,"0");
  const ampm=hours>=12?"pm":"am";
  hours=hours%12;if(hours===0)hours=12;
  let str="";
  if(timeMode===0){str=`${hours}:${minutes}${ampm}`;}
  else if(timeMode===1){str=`${days[now.getDay()]} ${months[now.getMonth()]} ${now.getDate()} ${hours}:${minutes}${ampm}`;}
  else if(timeMode===2){str="—";}
  else if(timeMode===3){const month=now.getMonth()+1;const day=now.getDate();str=`${month}/${day} ${hours}:${minutes}${ampm}`;}
  document.getElementById("datetime").textContent=str;
}
setInterval(updateClock,60000);
updateClock();

const overlayConversions = {
  xbox: [
    '<span class="mapping-pair"><span class="psx-x left">✕</span><span class="xbox-a right">A</span></span>',
    '<span class="mapping-pair"><span class="psx-o left">◯</span><span class="xbox-b right">B</span></span>',
    '<span class="mapping-pair"><span class="psx-sq left">▢</span><span class="xbox-x right">X</span></span>',
    '<span class="mapping-pair"><span class="psx-tri left">△</span><span class="xbox-y right bottom">Y</span></span>'
  ],
  nintendo: [
    '<span class="mapping-pair"><span class="psx-x left">✕</span><span class="nintendo-b right">B</span></span>',
    '<span class="mapping-pair"><span class="psx-o left">◯</span><span class="nintendo-a right">A</span></span>',
    '<span class="mapping-pair"><span class="psx-sq left">▢</span><span class="nintendo-y right">Y</span></span>',
    '<span class="mapping-pair"><span class="psx-tri left">△</span><span class="nintendo-x right bottom">X</span></span>'
  ],
  sega: [
    '<span class="mapping-pair"><span class="psx-x left">✕</span><span class="sega-a right">A</span></span>',
    '<span class="mapping-pair"><span class="psx-o left">◯</span><span class="sega-b right">B</span></span>',
    '<span class="mapping-pair"><span class="psx-sq left">▢</span><span class="sega-x right">X</span></span>',
    '<span class="mapping-pair"><span class="psx-tri left">△</span><span class="sega-y right bottom">Y</span></span>',
    '<span class="mapping-pair"><span class="psx-bumper left">R1</span><span class="sega-c right top-right">C</span></span>',
    '<span class="mapping-pair"><span class="psx-bumper left">L1</span><span class="sega-z right top-right">Z</span></span>'
  ]
};

const equalsConversions = {
  xbox: [
    '<span class="psx-x">✕</span> = <span class="xbox-a">A</span>',
    '<span class="psx-o">◯</span> = <span class="xbox-b">B</span>',
    '<span class="psx-sq">▢</span> = <span class="xbox-x">X</span>',
    '<span class="psx-tri">△</span> = <span class="xbox-y">Y</span>'
  ],
  nintendo: [
    '<span class="psx-x">✕</span> = B',
    '<span class="psx-o">◯</span> = A',
    '<span class="psx-sq">▢</span> = Y',
    '<span class="psx-tri">△</span> = X'
  ],
  sega: [
    '<span class="psx-x">✕</span> = <span class="sega-a">A</span>',
    '<span class="psx-o">◯</span> = <span class="sega-b">B</span>',
    '<span class="psx-sq">▢</span> = <span class="sega-x">X</span>',
    '<span class="psx-tri">△</span> = <span class="sega-y">Y</span>',
    '<span class="psx-bumper">R1</span>= <span class="sega-c">C</span>',
    '<span class="psx-bumper">L1</span>= <span class="sega-z">Z</span>'
  ]
};

render();
</script>
</body>
</html>
